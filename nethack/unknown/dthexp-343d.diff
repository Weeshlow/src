diff -urd nh343d/dat/opthelp nh343dexp/dat/opthelp
--- nh343d/dat/opthelp	2006-06-28 10:12:43.000000000 +0300
+++ nh343dexp/dat/opthelp	2006-06-28 10:17:40.000000000 +0300
@@ -61,6 +61,9 @@
 Boolean option if MFLOPPY was set at compile time:
 checkspace check free disk space before writing files to disk     [TRUE]
 
+Boolean option if DEATH_EXPLORE was set at compile time:
+death_explore prompt for changing to explore mode when you die    [FALSE]
+
 Boolean option if PARANOID was set at compile time:
 paranoid_hit   ask for explicit 'yes' when hitting peacefuls      [FALSE]
 
diff -urd nh343d/doc/Guidebook.mn nh343dexp/doc/Guidebook.mn
--- nh343d/doc/Guidebook.mn	2006-06-28 10:12:43.000000000 +0300
+++ nh343dexp/doc/Guidebook.mn	2006-06-28 10:17:40.000000000 +0300
@@ -1723,6 +1723,8 @@
 .lp "confirm "
 Have user confirm attacks on pets, shopkeepers, and other
 peaceable creatures (default on).
+.lp death_explore
+Prompt for changing to explore mode when your character dies.
 .lp DECgraphics
 Use a predefined selection of characters from the DEC VT-xxx/DEC
 Rainbow/ANSI line-drawing character set to display the dungeon/effects/traps
diff -urd nh343d/doc/Guidebook.tex nh343dexp/doc/Guidebook.tex
--- nh343d/doc/Guidebook.tex	2006-06-28 10:12:43.000000000 +0300
+++ nh343dexp/doc/Guidebook.tex	2006-06-28 10:17:40.000000000 +0300
@@ -2161,6 +2161,9 @@
 Have user confirm attacks on pets, shopkeepers, and other
 peaceable creatures (default on).
 %.lp
+\item[\ib{death_explore}]
+Prompt for changing to explore mode when your character dies.
+%.lp
 \item[\ib{DECgraphics}]
 Use a predefined selection of characters from the DEC VT-xxx/DEC
 Rainbow/ANSI line-drawing character set to display the dungeon/effects/traps
diff -urd nh343d/doc/Guidebook.txt nh343dexp/doc/Guidebook.txt
--- nh343d/doc/Guidebook.txt	2006-06-28 10:12:43.000000000 +0300
+++ nh343dexp/doc/Guidebook.txt	2006-06-28 10:17:40.000000000 +0300
@@ -2223,6 +2223,9 @@
             Have  user  confirm  attacks  on  pets,  shopkeepers, and other
             peaceable creatures (default on).
 
+          death_explore
+            Prompt for changing to explore mode when your character dies.
+
           DECgraphics
             Use a predefined selection  of  characters  from  the  DEC  VT-
             xxx/DEC  Rainbow/ANSI line-drawing character set to display the
diff -urd nh343d/include/flag.h nh343dexp/include/flag.h
--- nh343d/include/flag.h	2006-06-28 10:12:43.000000000 +0300
+++ nh343dexp/include/flag.h	2006-06-28 10:17:40.000000000 +0300
@@ -227,6 +227,9 @@
 	boolean  paranoid_quit; /* Ask for 'yes' when quitting */
 	boolean  paranoid_remove; /* Always show menu for 'T' and 'R' */
 #endif
+#ifdef DEATH_EXPLORE
+	boolean death_expl;	/* prompt for explore mode at death */
+#endif
 /*
  * Window capability support.
  */
diff -urd nh343d/src/cmd.c nh343dexp/src/cmd.c
--- nh343d/src/cmd.c	2006-06-28 10:12:43.000000000 +0300
+++ nh343dexp/src/cmd.c	2006-06-28 10:17:40.000000000 +0300
@@ -143,7 +143,7 @@
 STATIC_DCL int NDECL(wiz_port_debug);
 #  endif
 # endif
-STATIC_PTR int NDECL(enter_explore_mode);
+int NDECL(enter_explore_mode);	/* deathexplore patch */
 STATIC_PTR int NDECL(doattributes);
 STATIC_PTR int NDECL(doconduct); /**/
 STATIC_PTR boolean NDECL(minimal_enlightenment);
@@ -479,7 +479,7 @@
 	return 0;
 }
 
-STATIC_PTR int
+int	/* deathexplore patch */
 enter_explore_mode()
 {
 #ifdef PARANOID
diff -urd nh343d/src/end.c nh343dexp/src/end.c
--- nh343d/src/end.c	2006-06-28 10:12:43.000000000 +0300
+++ nh343dexp/src/end.c	2006-06-28 10:17:40.000000000 +0300
@@ -10,6 +10,9 @@
 #include <signal.h>
 #endif
 #include "dlb.h"
+#ifdef DEATH_EXPLORE
+extern int NDECL(enter_explore_mode);
+#endif
 
 	/* these probably ought to be generated by makedefs, like LAST_GEM */
 #define FIRST_GEM    DILITHIUM_CRYSTAL
@@ -656,6 +659,9 @@
 	int really_bon = TRUE;
 #endif
 	boolean taken;
+#ifdef DEATH_EXPLORE
+	boolean goexplore = FALSE;
+#endif
 	char kilbuf[BUFSZ], pbuf[BUFSZ];
 	winid endwin = WIN_ERR;
 	boolean bones_ok, have_windows = iflags.window_inited;
@@ -711,6 +717,7 @@
 			return;
 		}
 	}
+	bones_ok = (how < GENOCIDED) && can_make_bones(); /* dthexpl patch */
 	if ((
 #ifdef WIZARD
 			wizard ||
@@ -725,12 +732,27 @@
 		killer_format = 0;
 		return;
 	}
+#ifdef DEATH_EXPLORE
+	else if (iflags.death_expl && how <= GENOCIDED && !bones_ok &&
+#ifdef WIZARD
+		 !wizard &&
+#endif
+		 !discover) {
+	  if(yn("Continue in explore mode?") == 'y') {
+	    enter_explore_mode();
+	    if (discover) goexplore = TRUE;
+	  }
+	}
+#endif /* DEATH_EXPLORE */
 
     /*
      *	The game is now over...
      */
 
 die:
+#ifdef DEATH_EXPLORE
+	if (!goexplore) {
+#endif
 	program_state.gameover = 1;
 	/* in case of a subsequent panic(), there's no point trying to save */
 	program_state.something_worth_saving = 0;
@@ -750,6 +772,9 @@
 	  dump_screen();
 	}
 #endif /* DUMP_LOG */
+#ifdef DEATH_EXPLORE
+	}
+#endif
 	/* render vision subsystem inoperative */
 	iflags.vision_inited = 0;
 	/* might have been killed while using a disposable item, so make sure
@@ -764,6 +789,9 @@
 	    pline("Do not pass go.  Do not collect 200 %s.", currency(200L));
 
 	if (have_windows) wait_synch();	/* flush screen output */
+#ifdef DEATH_EXPLORE
+	if (!goexplore) {
+#endif
 #ifndef NO_SIGNAL
 	(void) signal(SIGINT, (SIG_RET_TYPE) done_intr);
 # if defined(UNIX) || defined(VMS) || defined (__EMX__)
@@ -772,7 +800,7 @@
 # endif
 #endif /* NO_SIGNAL */
 
-	bones_ok = (how < GENOCIDED) && can_make_bones();
+	/* bones_ok = (how < GENOCIDED) && can_make_bones(); moved up */
 
 	if (how == TURNED_SLIME)
 	    u.ugrave_arise = PM_GREEN_SLIME;
@@ -804,6 +832,9 @@
 		make_grave(u.ux, u.uy, pbuf);
 	    }
 	}
+#ifdef DEATH_EXPLORE
+	} /* if (!goexplore) */
+#endif
 
 	if (how == QUIT) {
 		killer_format = NO_KILLER_PREFIX;
@@ -824,6 +855,9 @@
 	    clearpriests();
 	} else	taken = FALSE;	/* lint; assert( !bones_ok ); */
 
+#ifdef DEATH_EXPLORE
+	if (!goexplore) {
+#endif
 	clearlocks();
 
 	if (have_windows) display_nhwindow(WIN_MESSAGE, FALSE);
@@ -847,6 +881,9 @@
 	}
 	/* finish_paybill should be called after disclosure but before bones */
 	if (bones_ok && taken) finish_paybill();
+#ifdef DEATH_EXPLORE
+	}
+#endif
 
 	/* calculate score, before creating bones [container gold] */
 	{
@@ -872,6 +909,25 @@
 	    if (deepest > 20)
 		u.urexp += 1000L * (long)((deepest > 30) ? 10 : deepest - 20);
 	    if (how == ASCENDED) u.urexp *= 2L;
+#ifdef DEATH_EXPLORE
+	    if (goexplore) {
+	      discover = FALSE; /* a kludge to fool the topten function.. */
+	      topten(how);
+	      /* undo some things that were done for score calculation */
+	      /* this branch is not entered when you ascend, escape or quit */
+	      discover = TRUE;
+	      umoney -= hidden_gold();
+	      u.urexp -= tmp;
+	      u.urexp -= 50L * (long)(deepest - 1);
+	      /* now do what is done when you refuse to die in explore mode */
+	      if (u.uhpmax <= 0) u.uhpmax = u.ulevel * 8;
+	      savelife(how);
+	      killer = 0;
+	      killer_format = 0;
+	      vision_reset();
+	      return;
+	    }
+#endif
 	}
 
 	if (bones_ok) {
diff -urd nh343d/src/options.c nh343dexp/src/options.c
--- nh343d/src/options.c	2006-06-28 10:12:43.000000000 +0300
+++ nh343dexp/src/options.c	2006-06-28 10:17:40.000000000 +0300
@@ -75,6 +75,9 @@
 	{"color",         &iflags.wc_color, FALSE, SET_IN_GAME},	/*WC*/
 # endif
 	{"confirm",&flags.confirm, TRUE, SET_IN_GAME},
+#ifdef DEATH_EXPLORE
+	{"death_explore", &iflags.death_expl, FALSE, SET_IN_GAME},
+#endif
 #if defined(TERMLIB) && !defined(MAC_GRAPHICS_ENV)
 	{"DECgraphics", &iflags.DECgraphics, FALSE, SET_IN_GAME},
 #else
